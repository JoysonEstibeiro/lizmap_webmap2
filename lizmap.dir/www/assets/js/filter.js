/*! For license information please see filter.js.LICENSE.txt */
(()=>{"use strict";const{entries:e,setPrototypeOf:t,isFrozen:i,getPrototypeOf:l,getOwnPropertyDescriptor:a}=Object;let{freeze:n,seal:r,create:o}=Object,{apply:f,construct:s}="undefined"!=typeof Reflect&&Reflect;n||(n=function(e){return e}),r||(r=function(e){return e}),f||(f=function(e,t,i){return e.apply(t,i)}),s||(s=function(e,t){return new e(...t)});const c=_(Array.prototype.forEach),u=_(Array.prototype.lastIndexOf),d=_(Array.prototype.pop),m=_(Array.prototype.push),p=_(Array.prototype.splice),g=_(String.prototype.toLowerCase),h=_(String.prototype.toString),v=_(String.prototype.match),b=_(String.prototype.replace),y=_(String.prototype.indexOf),T=_(String.prototype.trim),z=_(Object.prototype.hasOwnProperty),N=_(RegExp.prototype.test),M=(C=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return s(C,t)});var C;function _(e){return function(t){for(var i=arguments.length,l=new Array(i>1?i-1:0),a=1;a<i;a++)l[a-1]=arguments[a];return f(e,t,l)}}function E(e,l){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;t&&t(e,null);let n=l.length;for(;n--;){let t=l[n];if("string"==typeof t){const e=a(t);e!==t&&(i(l)||(l[n]=e),t=e)}e[t]=!0}return e}function x(e){for(let t=0;t<e.length;t++)z(e,t)||(e[t]=null);return e}function D(t){const i=o(null);for(const[l,a]of e(t))z(t,l)&&(Array.isArray(a)?i[l]=x(a):a&&"object"==typeof a&&a.constructor===Object?i[l]=D(a):i[l]=a);return i}function A(e,t){for(;null!==e;){const i=a(e,t);if(i){if(i.get)return _(i.get);if("function"==typeof i.value)return _(i.value)}e=l(e)}return function(){return null}}const S=n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w=n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I=n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),L=n(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),O=n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),k=n(["#text"]),P=n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),U=n(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),F=n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=r(/\{\{[\w\W]*|[\w\W]*\}\}/gm),B=r(/<%[\w\W]*|[\w\W]*%>/gm),G=r(/\$\{[\w\W]*/gm),W=r(/^data-[\-\w.\u00B7-\uFFFF]+$/),q=r(/^aria-[\-\w]+$/),Y=r(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),V=r(/^(?:\w+script|data):/i),K=r(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=r(/^html$/i),Z=r(/^[a-z][.\w]*(-[.\w]+)+$/i);var J=Object.freeze({__proto__:null,ARIA_ATTR:q,ATTR_WHITESPACE:K,CUSTOM_ELEMENT:Z,DATA_ATTR:W,DOCTYPE_NAME:X,ERB_EXPR:B,IS_ALLOWED_URI:Y,IS_SCRIPT_OR_DATA:V,MUSTACHE_EXPR:j,TMPLIT_EXPR:G});const Q=function(){return"undefined"==typeof window?null:window};var ee=function t(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q();const l=e=>t(e);if(l.version="3.2.4",l.removed=[],!i||!i.document||9!==i.document.nodeType||!i.Element)return l.isSupported=!1,l;let{document:a}=i;const r=a,f=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:C,Node:_,Element:x,NodeFilter:$,NamedNodeMap:j=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:B,DOMParser:G,trustedTypes:W}=i,q=x.prototype,V=A(q,"cloneNode"),K=A(q,"remove"),Z=A(q,"nextSibling"),ee=A(q,"childNodes"),te=A(q,"parentNode");if("function"==typeof C){const e=a.createElement("template");e.content&&e.content.ownerDocument&&(a=e.content.ownerDocument)}let ie,le="";const{implementation:ae,createNodeIterator:ne,createDocumentFragment:re,getElementsByTagName:oe}=a,{importNode:fe}=r;let se={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};l.isSupported="function"==typeof e&&"function"==typeof te&&ae&&void 0!==ae.createHTMLDocument;const{MUSTACHE_EXPR:ce,ERB_EXPR:ue,TMPLIT_EXPR:de,DATA_ATTR:me,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:he,CUSTOM_ELEMENT:ve}=J;let{IS_ALLOWED_URI:be}=J,ye=null;const Te=E({},[...S,...w,...I,...R,...k]);let ze=null;const Ne=E({},[...P,...U,...F,...H]);let Me=Object.seal(o(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ce=null,_e=null,Ee=!0,xe=!0,De=!1,Ae=!0,Se=!1,we=!0,Ie=!1,Le=!1,Re=!1,Oe=!1,ke=!1,$e=!1,Pe=!0,Ue=!1,Fe=!0,He=!1,je={},Be=null;const Ge=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let We=null;const qe=E({},["audio","video","img","source","image","track"]);let Ye=null;const Ve=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ke="http://www.w3.org/1998/Math/MathML",Xe="http://www.w3.org/2000/svg",Ze="http://www.w3.org/1999/xhtml";let Je=Ze,Qe=!1,et=null;const tt=E({},[Ke,Xe,Ze],h);let it=E({},["mi","mo","mn","ms","mtext"]),lt=E({},["annotation-xml"]);const at=E({},["title","style","font","a","script"]);let nt=null;const rt=["application/xhtml+xml","text/html"];let ot=null,ft=null;const st=a.createElement("form"),ct=function(e){return e instanceof RegExp||e instanceof Function},ut=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ft||ft!==e){if(e&&"object"==typeof e||(e={}),e=D(e),nt=-1===rt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ot="application/xhtml+xml"===nt?h:g,ye=z(e,"ALLOWED_TAGS")?E({},e.ALLOWED_TAGS,ot):Te,ze=z(e,"ALLOWED_ATTR")?E({},e.ALLOWED_ATTR,ot):Ne,et=z(e,"ALLOWED_NAMESPACES")?E({},e.ALLOWED_NAMESPACES,h):tt,Ye=z(e,"ADD_URI_SAFE_ATTR")?E(D(Ve),e.ADD_URI_SAFE_ATTR,ot):Ve,We=z(e,"ADD_DATA_URI_TAGS")?E(D(qe),e.ADD_DATA_URI_TAGS,ot):qe,Be=z(e,"FORBID_CONTENTS")?E({},e.FORBID_CONTENTS,ot):Ge,Ce=z(e,"FORBID_TAGS")?E({},e.FORBID_TAGS,ot):{},_e=z(e,"FORBID_ATTR")?E({},e.FORBID_ATTR,ot):{},je=!!z(e,"USE_PROFILES")&&e.USE_PROFILES,Ee=!1!==e.ALLOW_ARIA_ATTR,xe=!1!==e.ALLOW_DATA_ATTR,De=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ae=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Se=e.SAFE_FOR_TEMPLATES||!1,we=!1!==e.SAFE_FOR_XML,Ie=e.WHOLE_DOCUMENT||!1,Oe=e.RETURN_DOM||!1,ke=e.RETURN_DOM_FRAGMENT||!1,$e=e.RETURN_TRUSTED_TYPE||!1,Re=e.FORCE_BODY||!1,Pe=!1!==e.SANITIZE_DOM,Ue=e.SANITIZE_NAMED_PROPS||!1,Fe=!1!==e.KEEP_CONTENT,He=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||Y,Je=e.NAMESPACE||Ze,it=e.MATHML_TEXT_INTEGRATION_POINTS||it,lt=e.HTML_INTEGRATION_POINTS||lt,Me=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ct(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Me.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ct(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Me.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Me.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(xe=!1),ke&&(Oe=!0),je&&(ye=E({},k),ze=[],!0===je.html&&(E(ye,S),E(ze,P)),!0===je.svg&&(E(ye,w),E(ze,U),E(ze,H)),!0===je.svgFilters&&(E(ye,I),E(ze,U),E(ze,H)),!0===je.mathMl&&(E(ye,R),E(ze,F),E(ze,H))),e.ADD_TAGS&&(ye===Te&&(ye=D(ye)),E(ye,e.ADD_TAGS,ot)),e.ADD_ATTR&&(ze===Ne&&(ze=D(ze)),E(ze,e.ADD_ATTR,ot)),e.ADD_URI_SAFE_ATTR&&E(Ye,e.ADD_URI_SAFE_ATTR,ot),e.FORBID_CONTENTS&&(Be===Ge&&(Be=D(Be)),E(Be,e.FORBID_CONTENTS,ot)),Fe&&(ye["#text"]=!0),Ie&&E(ye,["html","head","body"]),ye.table&&(E(ye,["tbody"]),delete Ce.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ie=e.TRUSTED_TYPES_POLICY,le=ie.createHTML("")}else void 0===ie&&(ie=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null;const l="data-tt-policy-suffix";t&&t.hasAttribute(l)&&(i=t.getAttribute(l));const a="dompurify"+(i?"#"+i:"");try{return e.createPolicy(a,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+a+" could not be created."),null}}(W,f)),null!==ie&&"string"==typeof le&&(le=ie.createHTML(""));n&&n(e),ft=e}},dt=E({},[...w,...I,...L]),mt=E({},[...R,...O]),pt=function(e){m(l.removed,{element:e});try{te(e).removeChild(e)}catch(t){K(e)}},gt=function(e,t){try{m(l.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){m(l.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Oe||ke)try{pt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},ht=function(e){let t=null,i=null;if(Re)e="<remove></remove>"+e;else{const t=v(e,/^[\r\n\t ]+/);i=t&&t[0]}"application/xhtml+xml"===nt&&Je===Ze&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const l=ie?ie.createHTML(e):e;if(Je===Ze)try{t=(new G).parseFromString(l,nt)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(Je,"template",null);try{t.documentElement.innerHTML=Qe?le:l}catch(e){}}const n=t.body||t.documentElement;return e&&i&&n.insertBefore(a.createTextNode(i),n.childNodes[0]||null),Je===Ze?oe.call(t,Ie?"html":"body")[0]:Ie?t.documentElement:n},vt=function(e){return ne.call(e.ownerDocument||e,e,$.SHOW_ELEMENT|$.SHOW_COMMENT|$.SHOW_TEXT|$.SHOW_PROCESSING_INSTRUCTION|$.SHOW_CDATA_SECTION,null)},bt=function(e){return e instanceof B&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof j)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},yt=function(e){return"function"==typeof _&&e instanceof _};function Tt(e,t,i){c(e,(e=>{e.call(l,t,i,ft)}))}const zt=function(e){let t=null;if(Tt(se.beforeSanitizeElements,e,null),bt(e))return pt(e),!0;const i=ot(e.nodeName);if(Tt(se.uponSanitizeElement,e,{tagName:i,allowedTags:ye}),e.hasChildNodes()&&!yt(e.firstElementChild)&&N(/<[/\w]/g,e.innerHTML)&&N(/<[/\w]/g,e.textContent))return pt(e),!0;if(7===e.nodeType)return pt(e),!0;if(we&&8===e.nodeType&&N(/<[/\w]/g,e.data))return pt(e),!0;if(!ye[i]||Ce[i]){if(!Ce[i]&&Mt(i)){if(Me.tagNameCheck instanceof RegExp&&N(Me.tagNameCheck,i))return!1;if(Me.tagNameCheck instanceof Function&&Me.tagNameCheck(i))return!1}if(Fe&&!Be[i]){const t=te(e)||e.parentNode,i=ee(e)||e.childNodes;if(i&&t)for(let l=i.length-1;l>=0;--l){const a=V(i[l],!0);a.__removalCount=(e.__removalCount||0)+1,t.insertBefore(a,Z(e))}}return pt(e),!0}return e instanceof x&&!function(e){let t=te(e);t&&t.tagName||(t={namespaceURI:Je,tagName:"template"});const i=g(e.tagName),l=g(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Xe?t.namespaceURI===Ze?"svg"===i:t.namespaceURI===Ke?"svg"===i&&("annotation-xml"===l||it[l]):Boolean(dt[i]):e.namespaceURI===Ke?t.namespaceURI===Ze?"math"===i:t.namespaceURI===Xe?"math"===i&&lt[l]:Boolean(mt[i]):e.namespaceURI===Ze?!(t.namespaceURI===Xe&&!lt[l])&&!(t.namespaceURI===Ke&&!it[l])&&!mt[i]&&(at[i]||!dt[i]):!("application/xhtml+xml"!==nt||!et[e.namespaceURI]))}(e)?(pt(e),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!N(/<\/no(script|embed|frames)/i,e.innerHTML)?(Se&&3===e.nodeType&&(t=e.textContent,c([ce,ue,de],(e=>{t=b(t,e," ")})),e.textContent!==t&&(m(l.removed,{element:e.cloneNode()}),e.textContent=t)),Tt(se.afterSanitizeElements,e,null),!1):(pt(e),!0)},Nt=function(e,t,i){if(Pe&&("id"===t||"name"===t)&&(i in a||i in st))return!1;if(xe&&!_e[t]&&N(me,t));else if(Ee&&N(pe,t));else if(!ze[t]||_e[t]){if(!(Mt(e)&&(Me.tagNameCheck instanceof RegExp&&N(Me.tagNameCheck,e)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(e))&&(Me.attributeNameCheck instanceof RegExp&&N(Me.attributeNameCheck,t)||Me.attributeNameCheck instanceof Function&&Me.attributeNameCheck(t))||"is"===t&&Me.allowCustomizedBuiltInElements&&(Me.tagNameCheck instanceof RegExp&&N(Me.tagNameCheck,i)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(i))))return!1}else if(Ye[t]);else if(N(be,b(i,he,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(i,"data:")||!We[e])if(De&&!N(ge,b(i,he,"")));else if(i)return!1;return!0},Mt=function(e){return"annotation-xml"!==e&&v(e,ve)},Ct=function(e){Tt(se.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||bt(e))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ze,forceKeepAttr:void 0};let a=t.length;for(;a--;){const n=t[a],{name:r,namespaceURI:o,value:f}=n,s=ot(r);let u="value"===r?f:T(f);if(i.attrName=s,i.attrValue=u,i.keepAttr=!0,i.forceKeepAttr=void 0,Tt(se.uponSanitizeAttribute,e,i),u=i.attrValue,!Ue||"id"!==s&&"name"!==s||(gt(r,e),u="user-content-"+u),we&&N(/((--!?|])>)|<\/(style|title)/i,u)){gt(r,e);continue}if(i.forceKeepAttr)continue;if(gt(r,e),!i.keepAttr)continue;if(!Ae&&N(/\/>/i,u)){gt(r,e);continue}Se&&c([ce,ue,de],(e=>{u=b(u,e," ")}));const m=ot(e.nodeName);if(Nt(m,s,u)){if(ie&&"object"==typeof W&&"function"==typeof W.getAttributeType)if(o);else switch(W.getAttributeType(m,s)){case"TrustedHTML":u=ie.createHTML(u);break;case"TrustedScriptURL":u=ie.createScriptURL(u)}try{o?e.setAttributeNS(o,r,u):e.setAttribute(r,u),bt(e)?pt(e):d(l.removed)}catch(e){}}}Tt(se.afterSanitizeAttributes,e,null)},_t=function e(t){let i=null;const l=vt(t);for(Tt(se.beforeSanitizeShadowDOM,t,null);i=l.nextNode();)Tt(se.uponSanitizeShadowNode,i,null),zt(i),Ct(i),i.content instanceof s&&e(i.content);Tt(se.afterSanitizeShadowDOM,t,null)};return l.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,a=null,n=null,o=null;if(Qe=!e,Qe&&(e="\x3c!--\x3e"),"string"!=typeof e&&!yt(e)){if("function"!=typeof e.toString)throw M("toString is not a function");if("string"!=typeof(e=e.toString()))throw M("dirty is not a string, aborting")}if(!l.isSupported)return e;if(Le||ut(t),l.removed=[],"string"==typeof e&&(He=!1),He){if(e.nodeName){const t=ot(e.nodeName);if(!ye[t]||Ce[t])throw M("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof _)i=ht("\x3c!----\x3e"),a=i.ownerDocument.importNode(e,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?i=a:i.appendChild(a);else{if(!Oe&&!Se&&!Ie&&-1===e.indexOf("<"))return ie&&$e?ie.createHTML(e):e;if(i=ht(e),!i)return Oe?null:$e?le:""}i&&Re&&pt(i.firstChild);const f=vt(He?e:i);for(;n=f.nextNode();)zt(n),Ct(n),n.content instanceof s&&_t(n.content);if(He)return e;if(Oe){if(ke)for(o=re.call(i.ownerDocument);i.firstChild;)o.appendChild(i.firstChild);else o=i;return(ze.shadowroot||ze.shadowrootmode)&&(o=fe.call(r,o,!0)),o}let u=Ie?i.outerHTML:i.innerHTML;return Ie&&ye["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&N(X,i.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+u),Se&&c([ce,ue,de],(e=>{u=b(u,e," ")})),ie&&$e?ie.createHTML(u):u},l.setConfig=function(){ut(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Le=!0},l.clearConfig=function(){ft=null,Le=!1},l.isValidAttribute=function(e,t,i){ft||ut({});const l=ot(e),a=ot(t);return Nt(l,a,i)},l.addHook=function(e,t){"function"==typeof t&&m(se[e],t)},l.removeHook=function(e,t){if(void 0!==t){const i=u(se[e],t);return-1===i?void 0:p(se[e],i,1)[0]}return d(se[e])},l.removeHooks=function(e){se[e]=[]},l.removeAllHooks=function(){se={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},l}();lizMap.events.on({uicreated:function(){if(!globalThis.filterConfig||globalThis.filterConfig.constructor===Object&&0===Object.keys(globalThis.filterConfig).length)return $("#mapmenu li.filter.nav-dock").addClass("hide"),!0;function e(e){var i=lizMap.getLayerConfigById(e);if(!i)return!1;var l=i[0];globalThis.filterConfigData.layerName=l,$("div.liz-filter-field-box").remove(),function(){var e=globalThis.filterConfigData.layerId,i=[];for(var l in globalThis.filterConfig)"title"in(n=globalThis.filterConfig[l])&&n.layerId==e&&(i.push(n),$("#filter div.tree").append('<div id="filter-field-order'+String(n.order)+'"></div>'));for(var a in i){var n;t(n=i[a])}}(),lizMap.events.on({dockopened:function(e){"filter"==e.id&&lizMap.updateContentSize()},rightdockclosed:function(){},minidockclosed:function(){},layerfeatureremovefilter:function(){var e=globalThis.filterConfigData.layerId;for(var t in globalThis.filterConfigData.filter=void 0,globalThis.filterConfigData.deactivated=!0,globalThis.filterConfig){var i=globalThis.filterConfig[t];"title"in i&&i.layerId===e&&f(i.order)}globalThis.filterConfigData.deactivated=!1,u()}}),u(),$("#liz-filter-zoom").is(":visible")&&d()}function t(e){var t=globalThis.filterConfig[e.order];return"uniquevalues"==t.type?function(e){const t=[];var a={request:"getUniqueValues",layerId:e.layerId,fieldname:e.field,filter:""};t.push(fetch(globalThis.filterConfigData.url+"&"+new URLSearchParams(a)).then((e=>e.json())));let n={};const r=lizMap.getLayerConfigById(e.layerId)[0],o=lizMap.keyValueConfig[r]?.[e.field];if(o)if("ValueMap"==o.type)n=o.data;else{let e=lizMap.getLayerConfigById(o.source_layer_id);if(e&&2==e.length){const i=e[1],l=i?.shortname||i?.typename||i?.name;null!=l&&t.push(lizMap.mainLizmap.wfs.getFeature({TYPENAME:l,PROPERTYNAME:o.code_field+","+o.label_field,EXP_FILTER:o.exp_filter?o.exp_filter:""}))}}Promise.all(t).then((t=>{const[a,r]=t;if(!l(a))return!1;r&&r.features.forEach((e=>n[e.properties[o.code_field]]=e.properties[o.label_field]));var f="";f+=i(e),"select"==e.format&&(f+='<select id="liz-filter-field-'+lizMap.cleanName(e.title)+'" class="liz-filter-field-select">',f+='<option value=""> --- </option>',f+="</select>"),f+="</p></div>",$("#filter-field-order"+String(e.order)).append(f),"items"in globalThis.filterConfig[e.order]||(globalThis.filterConfig[e.order].items={});for(const t of a)globalThis.filterConfig[e.order].items[ee.sanitize(t.v)]=t.c;var s="",u=Object.keys(globalThis.filterConfig[e.order].items);u.sort((function(e,t){return e.localeCompare(t)}));for(const t of u){var d=n.hasOwnProperty(t)?n[t]:t;"select"==e.format?s+=`<option value="${lizMap.cleanName(t)}">${d}</option>`:s+=`<label class="checkbox"><input id="${"liz-filter-field-"+lizMap.cleanName(e.title)+"-"+lizMap.cleanName(t)}" class="liz-filter-field-value" type="checkbox" value="${lizMap.cleanName(t)}">${d}</label>`}var m="liz-filter-box-"+lizMap.cleanName(e.title);"select"==e.format?$("#"+m+" select").append(s):$("#"+m+" p").append(s),c(e)}))}(e):"date"==t.type?function(e){var t="min_date",a="max_date";lizMap.getLizmapDesktopPluginMetadata().lizmap_web_client_target_version>=30700&&(t="start_field",a="end_field");const n=a in e?e[a]:e[t];var r={request:"getMinAndMaxValues",layerId:e.layerId,fieldname:e[t]+","+n,filter:""};$.get(globalThis.filterConfigData.url,r,(function(t){if(!l(t))return!1;for(var a in t){var n=t[a];"+"===n.min[n.min.length-3]&&(n.min=n.min+":00"),"+"===n.max[n.max.length-3]&&(n.max=n.max+":00");var r=s(new Date(n.min),"yy-mm-dd"),o=s(new Date(n.max),"yy-mm-dd");globalThis.filterConfig[e.order].min=r,globalThis.filterConfig[e.order].max=o}var f="";f+=i(e),f+='<span style="white-space:nowrap">',f+='<input id="liz-filter-field-min-date'+lizMap.cleanName(e.title)+'" class="liz-filter-field-date" value="'+e.min+'" style="width:100px;">',f+='<input id="liz-filter-field-max-date'+lizMap.cleanName(e.title)+'" class="liz-filter-field-date" value="'+e.max+'" style="width:100px;">',f+="</span>",f+='<div id="liz-filter-datetime-range'+lizMap.cleanName(e.title)+'">',f+="    <div>",f+='        <div id="liz-filter-slider-range'+lizMap.cleanName(e.title)+'"></div>',f+="    </div>",f+="</div>",f+="</p></div>",$("#filter-field-order"+String(e.order)).append(f),$("#filter input.liz-filter-field-date").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,minDate:new Date(n.min),maxDate:new Date(n.max)}),c(e)}),"json")}(e):"numeric"==t.type?function(e){var t="";lizMap.getLizmapDesktopPluginMetadata().lizmap_web_client_target_version>=30700?(t+=e.start_field,"end_field"in e&&""!=e.end_field&&(t+=","+e.end_field)):t+=e.field;var a={request:"getMinAndMaxValues",layerId:e.layerId,fieldname:t,filter:""};$.get(globalThis.filterConfigData.url,a,(function(t){if(!l(t))return!1;for(var a in t){var n=t[a];globalThis.filterConfig[e.order].min=Number(n.min),globalThis.filterConfig[e.order].max=Number(n.max)}var r="";r+=i(e),r+='<span style="white-space:nowrap">',r+='<input id="liz-filter-field-min-numeric'+lizMap.cleanName(e.title)+'" type="number" value="'+e.min+'" step="1" min="'+e.min+'" max="'+e.max+'" class="liz-filter-field-numeric" style="width:100px;">',r+='<input id="liz-filter-field-max-numeric'+lizMap.cleanName(e.title)+'" type="number" value="'+e.max+'" step="'+e.step+'" min="'+e.min+'" max="'+e.max+'" class="liz-filter-field-numeric" style="width:100px;">',r+="</span>",r+='<div id="liz-filter-numeric-range'+lizMap.cleanName(e.title)+'">',r+="    <div>",r+='        <div id="liz-filter-slider-range'+lizMap.cleanName(e.title)+'"></div>',r+="    </div>",r+="</div>",r+="</p></div>",$("#filter-field-order"+String(e.order)).append(r),c(e)}),"json")}(e):"text"==t.type?function(e){var t=e.field,a={request:"getUniqueValues",layerId:e.layerId,fieldname:t,filter:""};$.get(globalThis.filterConfigData.url,a,(function(t){if(!l(t))return!1;var a=[];for(var n in t){var r=t[n];null===r.v||!r.v||"string"==typeof r.v&&""===r.v.trim()||a.push(r.v)}var o="";o+=i(e),o+='<div style="width: 100%;">',o+='<input id="liz-filter-field-text'+lizMap.cleanName(e.title)+'" class="liz-filter-field-text" value="" title="'+lizDict["filter.input.text.title"]+'" placeholder="'+lizDict["filter.input.text.placeholder"]+'">',o+="</div>",o+="</p></div>",$("#filter-field-order"+String(e.order)).append(o),c(e),$("#liz-filter-field-text"+lizMap.cleanName(e.title)).autocomplete({source:a,autoFocus:!1,delay:200,minLength:2,select:function(e,t){$(this).val(t.item.value),$(this).change()}})}),"json")}(e):""}function i(e){var t="";return t+='<div class="liz-filter-field-box" id="liz-filter-box-',t+=lizMap.cleanName(e.title),t+='">',t+='<span style="font-weight:bold;">'+e.title+"</span>",(t+='<button class="btn btn-primary btn-mini pull-right liz-filter-reset-field" title="'+lizDict["filter.btn.reset.title"]+'" value="'+e.order+'">x</button>')+"<p>"}function l(e){return!(!e||"status"in e&&"error"==e.status&&(console.log(e.title+": "+e.detail),1))}function a(e){if(globalThis.filterConfigData.deactivated)return!1;"uniquevalues"==e.type&&function(e){var t=globalThis.filterConfig[e.order];globalThis.filterConfig[e.order].data={};var i=!0,l=!0;if("select"==t.format){var a="#liz-filter-field-"+lizMap.cleanName(e.title),n=$(a).val(),r=[];for(var o in globalThis.filterConfig[e.order].items){if(Array.isArray(n))var f=n.includes(lizMap.cleanName(o));else f=n==lizMap.cleanName(o);f?(l=!1,r.push(o.replace(/'/g,"''"))):i=!1,globalThis.filterConfig[e.order].data[o]=f}}if("checkboxes"==t.format)for(var o in r=[],globalThis.filterConfig[e.order].items){var s="#liz-filter-field-"+lizMap.cleanName(e.title)+"-"+lizMap.cleanName(o);(f=$(s).is(":checked"))?(l=!1,r.push(o.replace(/'/g,"''"))):i=!1,globalThis.filterConfig[e.order].data[o]=f}globalThis.filterConfig[e.order].allchecked=i,globalThis.filterConfig[e.order].nonechecked=l,globalThis.filterConfig[e.order].selected=r;var c=null,u=e.field;if(r.length){let t=!1;if("splitter"in e&&""!=e.splitter){c=" ( ";var d="",m="LIKE";for(var p in"postgres"==e.provider&&(m="ILIKE"),r){var g=r[p];""===g&&(t=!0),c+=d+'"'+u+'" '+m+" '%"+g+"%' ",d=" OR "}t&&(c+=` OR "${u}" IS NULL `),c+=" ) "}else r.includes("")&&(t=!0),c='"'+u+"\" IN ( '"+r.join("' , '")+"' ) ",t&&(c=` ( ${c} OR "${u}" IS NULL ) `)}globalThis.filterConfig[e.order].filter=c}(e),"date"==e.type&&function(e){var t=[],i="#liz-filter-field-min-date"+lizMap.cleanName(e.title),l="#liz-filter-field-max-date"+lizMap.cleanName(e.title),a=$(i).val().trim(),n=$(l).val().trim();if(a==e.min&&n==e.max)return globalThis.filterConfig[e.order].filter=null,!0;var r="min_date",o="max_date";lizMap.getLizmapDesktopPluginMetadata().lizmap_web_client_target_version>=30700&&(r="start_field",o="end_field");const f=e[r],c=o in e?e[o]:e[r];if(a&&Date.parse(a)?t.push('( "'+f+"\" >= '"+a+"' OR  \""+c+"\" >= '"+a+"' )"):a=null,n&&Date.parse(n)){let e=new Date(Date.parse(n));e.setDate(e.getDate()+1);let i=s(e,"yy-mm-dd");t.push('( "'+f+"\" < '"+i+"' OR  \""+c+"\" < '"+i+"' )")}else n=null;var u=null;t.length&&(u=" ( ",u+=t.join(" AND "),u+=" ) "),globalThis.filterConfig[e.order].data={min_date:a,max_date:n},globalThis.filterConfig[e.order].filter=u}(e),"numeric"==e.type&&function(e){var t=[],i="#liz-filter-field-min-numeric"+lizMap.cleanName(e.title),l="#liz-filter-field-max-numeric"+lizMap.cleanName(e.title),a=$(i).val().trim(),n=$(l).val().trim();if(a==e.min&&n==e.max)return globalThis.filterConfig[e.order].filter=null,!0;var r="",o=null;if(lizMap.getLizmapDesktopPluginMetadata().lizmap_web_client_target_version>=30700?(r=e.start_field,o="end_field"in e&&""!=e.end_field?e.end_field:r):r=e.field,""!=a){var f="( ";f+='"'+r+"\" >= '"+a+"'",o&&(f+=' OR  "'+o+"\" >= '"+a+"'"),f+=" )",t.push(f)}else a=null;if(""!=n){var s="( ";s+='"'+r+"\" <= '"+n+"'",o&&(s+=' OR  "'+o+"\" <= '"+n+"'"),s+=" )",t.push(s)}else n=null;var c=null;t.length&&(c=" ( ",c+=t.join(" AND "),c+=" ) "),globalThis.filterConfig[e.order].data={min:a,max:n},globalThis.filterConfig[e.order].filter=c}(e),"text"==e.type&&function(e){var t="#liz-filter-field-text"+lizMap.cleanName(e.title),i=$(t).val().trim().replace(/'/g,"''");globalThis.filterConfig[e.order].data={text:i};var l=null,a="LIKE";"postgres"==e.provider&&(a="ILIKE");var n=e.field;i&&(l='"'+n+'" '+a+" '%"+i+"%'"),globalThis.filterConfig[e.order].data={text:i},globalThis.filterConfig[e.order].filter=l}(e),r()}function n(){var e="simple";if(globalThis.filterConfigData.hasOwnProperty("filterMethod")&&("simple"==(e=globalThis.filterConfigData.filterMethod)||"full"==e))return e;var t=globalThis.filterConfigData.layerName;return"attributeLayers"in lizMap.config&&t in lizMap.config.attributeLayers&&1==lizMap.config.attributeLayers[t].primaryKey.split(",").length&&(e="full"),e}function r(){var e=globalThis.filterConfigData.layerId,t=globalThis.filterConfigData.layerName,i=[];for(var a in globalThis.filterConfig){var r=globalThis.filterConfig[a];"title"in r&&r.filter&&r.layerId==e&&i.push(r.filter)}var f=i.join(" AND ");if(0==i.length||""==f.trim())return o(),!0;"simple"==n()?lizMap.triggerLayerFilter(t,f):function(e,t,i){e=void 0!==e?e:"";var a={request:"getUniqueValues",layerId:globalThis.filterConfigData.layerId,fieldname:t,filter:e};$.get(globalThis.filterConfigData.url,a,(function(e){if(!l(e))return!1;var t=[];for(var a in e){var n=e[a];null===n.v||!n.v||"string"==typeof n.v&&""===n.v.trim()||t.push(n.v)}i&&i(t)}),"json")}(f,lizMap.config.attributeLayers[t].primaryKey,(function(e){0==e.length&&(e=[-9999999]),lizMap.config.layers[t].selectedFeatures||(lizMap.config.layers[t].selectedFeatures=[]),lizMap.config.layers[t].selectedFeatures=e,lizMap.events.triggerEvent("layerfeaturefilterselected",{featureType:t})})),u(f),$("#liz-filter-zoom").is(":visible")&&d(f),globalThis.filterConfigData.filter=f}function o(){var e=globalThis.filterConfigData.layerId;for(var t in globalThis.filterConfigData.filter=void 0,globalThis.filterConfigData.deactivated=!0,globalThis.filterConfig){var i=globalThis.filterConfig[t];"title"in i&&i.layerId==e&&f(i.order)}globalThis.filterConfigData.deactivated=!1;var l=globalThis.filterConfigData.layerName;"simple"==n()?(lizMap.deactivateMaplayerFilter(l),lizMap.events.triggerEvent("layerFilterParamChanged",{featureType:l,filter:null,updateDrawing:!1})):lizMap.events.triggerEvent("layerfeatureremovefilter",{featureType:l}),u(),$("#liz-filter-zoom").is(":visible")&&d(),lizMap.mainLizmap.map.clearHighlightFeatures()}function f(e){var t=globalThis.filterConfig[e];if("date"==t.type)$("#liz-filter-field-min-date"+lizMap.cleanName(t.title)).val(t.min),$("#liz-filter-field-max-date"+lizMap.cleanName(t.title)).val(t.max).change();else if("numeric"==t.type)$("#liz-filter-field-min-numeric"+lizMap.cleanName(t.title)).val(t.min),$("#liz-filter-field-max-numeric"+lizMap.cleanName(t.title)).val(t.max).change();else if("uniquevalues"==t.type){if("checkboxes"==t.format)$("#liz-filter-box-"+lizMap.cleanName(t.title)+" input.liz-filter-field-value").prop("checked",!1);else if("select"==t.format){var i=$("#liz-filter-field-"+lizMap.cleanName(t.title));if("sumo"in i[0])i[0].hasAttribute("multiple")?i[0].sumo.unSelectAll():i[0].sumo.unSelectItem(i.val());else{var l=i.find("option:first").val();i.val(l)}}}else"text"==t.type&&$("#liz-filter-field-text"+lizMap.cleanName(t.title)).val("");globalThis.filterConfig[t.order].filter=null}function s(e,t){return $.datepicker.formatDate(t,e)}function c(e){var t="liz-filter-box-"+lizMap.cleanName(e.title),i=globalThis.filterConfig[e.order];if("uniquevalues"==e.type&&("checkboxes"==e.format&&$("#"+t+" input.liz-filter-field-value").click((function(){if($(this).hasClass("disabled"))return!1;a(e)})),"select"==e.format&&$("#liz-filter-field-"+lizMap.cleanName(e.title)).change((function(){a(e)}))),"date"==i.type){if(c=!0){var l=Date.parse(e.min)/1e3,n=Date.parse(e.max)/1e3,o=null;function u(t,i){if(globalThis.filterConfigData.deactivated)return!1;clearTimeout(o),o=setTimeout((function(){var t=new Date(1e3*i.values[0]);$("#liz-filter-field-min-date"+lizMap.cleanName(e.title)).val(s(t,"yy-mm-dd"));var l=new Date(1e3*i.values[1]);$("#liz-filter-field-max-date"+lizMap.cleanName(e.title)).val(s(l,"yy-mm-dd")),a(e)}),150)}$("#liz-filter-slider-range"+lizMap.cleanName(e.title)).slider({range:!0,min:l,max:n,step:86400,values:[l,n],change:function(e,t){u(0,t)},slide:function(t,i){var l=new Date(1e3*i.values[0]);$("#liz-filter-field-min-date"+lizMap.cleanName(e.title)).val(s(l,"yy-mm-dd"));var a=new Date(1e3*i.values[1]);$("#liz-filter-field-max-date"+lizMap.cleanName(e.title)).val(s(a,"yy-mm-dd"))}})}$("#liz-filter-field-min-date"+lizMap.cleanName(e.title)+", #liz-filter-field-max-date"+lizMap.cleanName(e.title)).change((function(){c?$("#liz-filter-slider-range"+lizMap.cleanName(e.title)).slider("values",[Date.parse($("#liz-filter-field-min-date"+lizMap.cleanName(e.title)).val())/1e3,Date.parse($("#liz-filter-field-max-date"+lizMap.cleanName(e.title)).val())/1e3]):a(e)}))}if("numeric"==i.type){var c;if(c=!0){function d(t,i){if(globalThis.filterConfigData.deactivated)return!1;clearTimeout(o),o=setTimeout((function(){var t=i.values[0];$("#liz-filter-field-min-numeric"+lizMap.cleanName(e.title)).val(t);var l=i.values[1];$("#liz-filter-field-max-numeric"+lizMap.cleanName(e.title)).val(l),a(e)}),300)}l=e.min,n=e.max,o=null,$("#liz-filter-slider-range"+lizMap.cleanName(e.title)).slider({range:!0,min:l,max:n,step:1,values:[l,n],change:function(e,t){d(0,t)},slide:function(t,i){var l=i.values[0];$("#liz-filter-field-min-numeric"+lizMap.cleanName(e.title)).val(l);var a=i.values[1];$("#liz-filter-field-max-numeric"+lizMap.cleanName(e.title)).val(a)}})}$("#liz-filter-field-min-numeric"+lizMap.cleanName(e.title)+", #liz-filter-field-max-numeric"+lizMap.cleanName(e.title)).change((function(){c?$("#liz-filter-slider-range"+lizMap.cleanName(e.title)).slider("values",[$("#liz-filter-field-min-numeric"+lizMap.cleanName(e.title)).val(),$("#liz-filter-field-max-numeric"+lizMap.cleanName(e.title)).val()]):a(e)}))}"text"==i.type&&$("#liz-filter-field-text"+lizMap.cleanName(e.title)).change((function(){a(e)})),$("#liz-filter-box-"+lizMap.cleanName(e.title)+" button.liz-filter-reset-field").click((function(){f($(this).val()),r()})),$("#liz-filter-box-"+lizMap.cleanName(e.title)+" [title]").tooltip()}function u(e){e=void 0!==e?e:"";var t={request:"getFeatureCount",layerId:globalThis.filterConfigData.layerId,filter:e};$.get(globalThis.filterConfigData.url,t,(function(e){if(!e)return!1;if("status"in e&&"error"==e.status)return console.log(e.title+": "+e.detail),!1;for(var t in e){var i=e[t],l=i.c;try{l=(new Intl.NumberFormat).format(l)}catch(e){l=i.c}$("#liz-filter-item-layer-total-count").html(l)}}),"json")}function d(e){e=void 0!==e?e:"";var t=globalThis.filterConfigData.layerId,i=lizMap.map.getProjection();"EPSG:900913"==i&&(i="EPSG:3857");var l=globalThis.filterConfigData.layerName;if(!e){var a=lizMap.config.layers[l];if("bbox"in a){var n=a.bbox[i].bbox,r=n[0]+","+n[1]+","+n[2]+","+n[3];$("#liz-filter-zoom").val(r)}return!1}var o={request:"getExtent",layerId:t,filter:e,crs:i};$.get(globalThis.filterConfigData.url,o,(function(e){if(!e)return!1;if("status"in e&&"error"==e.status)return console.log(e.title+": "+e.detail),void $("#liz-filter-zoom").hide();for(var t in e){var i=e[t].bbox;if(!i)return!1;var l=$.parseJSON(i).bbox,a=l[0]+","+l[1]+","+l[2]+","+l[3];$("#liz-filter-zoom").val(a)}}),"json")}!function(){if(!globalThis.filterConfig||globalThis.filterConfig.constructor===Object&&0===Object.keys(globalThis.filterConfig).length)return!1;var e=function(){var e="";e+='<div class="menu-content">',e+='<select id="liz-filter-layer-selector">';var t={};for(var i in globalThis.filterConfig){var l=globalThis.filterConfig[i];if(!(l.layerId in t)){var a=l.layerId,n=lizMap.getLayerConfigById(a);if(!n)continue;var r=n[0],o=n[1],f=r;"title"in o&&""!=o.title&&(f=o.title),e+='<option value="'+a+'">'+f+"</option>",t[a]=!0}}return e+="</select></br>",e+='<b><span id="liz-filter-item-layer-total-count">0</span> '+lizDict["filter.label.features"]+"</b>",e+='<br/><button id="liz-filter-zoom" class="btn btn-mini btn-primary" title="'+lizDict["filter.btn.zoom.title"]+'">'+lizDict["filter.btn.zoom.label"]+"</button>",lizMap.getVectorLayerResultFormat().includes("ODS")&&(e+='&nbsp;&nbsp;<button id="liz-filter-export" class="btn btn-mini btn-primary" title="'+lizDict["filter.btn.export.title"]+'">'+lizDict["filter.btn.export.label"]+"</button>"),e+='&nbsp;&nbsp;<button id="liz-filter-unfilter" class="btn btn-mini btn-primary" title="'+lizDict["filter.btn.reset.title"]+'">'+lizDict["filter.btn.reset.label"]+"</button>",(e+="</div>")+'<div style="padding:10px 10px;" class="tree menu-content"></div>'}();$("#filter-content").html(e);var t=globalThis.filterConfig[0].layerId;globalThis.filterConfigData.layerId=t,$("#liz-filter-unfilter").click((function(){return o(),!1})),$("#liz-filter-zoom").click((function(){return function(){var e=$("#liz-filter-zoom").val(),t=null;if(e&&(t=e.split(",")),!e||4!=t.length)return!1;lizMap.mainLizmap.map.getView().fit(t)}(),!1})),lizMap.getVectorLayerResultFormat().includes("ODS")&&$("#liz-filter-export").click((function(){return lizMap.config.layers[globalThis.filterConfigData.layerName].request_params.filter=globalThis.filterConfigData.filter,lizMap.exportVectorLayer(globalThis.filterConfigData.layerName,"ODS",!1),delete lizMap.config.layers[globalThis.filterConfigData.layerName].request_params.filter,!1})),$("#filter-content [title]").tooltip()}(),e(globalThis.filterConfigData.layerId),$("#liz-filter-layer-selector").change((function(){o(),globalThis.filterConfigData.layerId=$(this).val(),e($(this).val())}))}})})();
//# sourceMappingURL=filter.js.map